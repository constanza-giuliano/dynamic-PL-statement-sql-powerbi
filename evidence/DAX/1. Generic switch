1. ER GENERICO % / bruto = 

SWITCH( 
    TRUE(),  
    SELECTEDVALUE(Dim_Value[VALOR])="$ ARG",
    CALCULATE(

SWITCH( 
    TRUE(),  
    SELECTEDVALUE(Dim_Unit[Unidad])="$",
    CALCULATE(

SWITCH( 
    TRUE(),  
    SELECTEDVALUE(Dim_avg[Promedio])="YES",
    CALCULATE(Fact_Expenses[Resultado neto]/ DISTINCTCOUNT(Dim_Date[Mes])),
    SELECTEDVALUE(Dim_avg[Promedio])<>"YES",
    CALCULATE( Fact_Expenses[Resultado neto])
    
)),
    SELECTEDVALUE(Dim_Unit[Unidad])="%",
   CALCULATE(
       
 SWITCH( 
    TRUE(),  
    SELECTEDVALUE(Dim_avg[Promedio])="YES",
    CALCULATE(Fact_Expenses[1. porcentajes / bruto Promedio]),
    SELECTEDVALUE(Dim_avg[Promedio])<>"YES",
    CALCULATE(Fact_Expenses[1. porcentajes / bruto]))

))),
    SELECTEDVALUE(Dim_Value[VALOR])="USD",
    CALCULATE(

SWITCH( 
    TRUE(),  
    SELECTEDVALUE(Dim_Unit[Unidad])="$",
   CALCULATE(
SWITCH( 
    TRUE(),  
    SELECTEDVALUE(Dim_avg[Promedio])="YES",
    CALCULATE(Fact_Expenses[Resultado Neto USD]/ DISTINCTCOUNT(Dim_Date[Mes])),
    SELECTEDVALUE(Dim_avg[Promedio])<>"YES",
    CALCULATE( Fact_Expenses[Resultado Neto USD])
    
)),
    SELECTEDVALUE(Dim_Unit[Unidad])="%",
    CALCULATE(
SWITCH( 
    TRUE(),  
    SELECTEDVALUE(Dim_avg[Promedio])="YES",
    CALCULATE(Fact_Expenses[1. porcentajes / bruto Promedio]),
    SELECTEDVALUE(Dim_avg[Promedio])<>"YES",
   CALCULATE(Fact_Expenses[1. porcentajes / bruto]))     




))))
